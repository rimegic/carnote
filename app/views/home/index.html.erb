<!-- Hero Section -->
<section class="relative bg-gradient-to-br from-blue-50 to-indigo-100 py-12 sm:py-16 lg:py-20 xl:py-24 overflow-hidden min-h-[80vh] flex items-center">
  <!-- Background Car Image -->
  <div class="absolute inset-0 z-0">
    <img src="/generated_images/hero_car_bg.jpg" alt="Hero Car" class="w-full h-full object-cover opacity-10">
  </div>
  
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 xl:px-12 relative z-10 w-full">
    <div class="text-center">
      <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold text-gray-900 mb-4 sm:mb-6 lg:mb-8 leading-tight">
        <span class="block">ì‹ ì°¨ êµ¬ë§¤ì˜ ìƒˆë¡œìš´ ê¸°ì¤€</span>
        <span class="text-blue-600 block mt-2">ì¹´ë…¸íŠ¸ì—ì„œ ì‹œì‘í•˜ì„¸ìš”</span>
      </h1>
      <p class="text-base sm:text-lg md:text-xl lg:text-2xl text-gray-600 mb-6 sm:mb-8 lg:mb-12 max-w-4xl mx-auto px-4 sm:px-0 leading-relaxed">
        <span class="block">ì „êµ­ 700ê°œ ì „ì‹œì¥, 8ì²œëª…ì˜ ë”œëŸ¬ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•œ</span>
        <span class="block mt-2">ì‹¤ì‹œê°„ í• ì¸ ì •ë³´, ê¸ˆìœµ ìƒí’ˆìœ¼ë¡œ ì‹ ì°¨ êµ¬ë§¤ë¥¼ ê²½í—˜í•˜ì„¸ìš”</span>
      </p>
      
      <!-- Quote Request Form -->
      <div class="max-w-5xl mx-auto mb-8 sm:mb-12 lg:mb-16 px-4 sm:px-0">
        <div class="bg-white rounded-xl sm:rounded-2xl shadow-xl sm:shadow-2xl p-4 sm:p-6 lg:p-8 border border-gray-100">
          <h3 class="text-lg sm:text-xl lg:text-2xl font-semibold text-gray-900 mb-4 sm:mb-6 text-center">ë¬´ë£Œ ì‹ ì°¨ ê²¬ì  ë°›ê¸°</h3>
          <%= form_with url: cars_path, method: :get, local: true, id: "quote-form", html: { autocomplete: "off" } do |f| %>
            <!-- ì£¼ìš” ì„ íƒ ì˜µì…˜ -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6 mb-4 sm:mb-6">
              <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700 sm:hidden">ë¸Œëœë“œ</label>
                <%= f.select "brand", options_for_select([
                  ["ë¸Œëœë“œ ì„ íƒ", ""],
                  ["í˜„ëŒ€", "í˜„ëŒ€"],
                  ["ê¸°ì•„", "ê¸°ì•„"],
                  ["ì œë„¤ì‹œìŠ¤", "ì œë„¤ì‹œìŠ¤"],
                  ["BMW", "BMW"],
                  ["ë²¤ì¸ ", "ë²¤ì¸ "],
                  ["ì•„ìš°ë””", "ì•„ìš°ë””"],
                  ["ë³¼ë³´", "ë³¼ë³´"],
                  ["ë ‰ì„œìŠ¤", "ë ‰ì„œìŠ¤"]
                ]), {}, { 
                  class: "w-full px-3 sm:px-4 py-3 sm:py-4 text-sm sm:text-base border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white hover:border-blue-300",
                  id: "brand-select",
                  autocomplete: "off"
                } %>
              </div>
              <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700 sm:hidden">ëª¨ë¸</label>
                <%= f.select "model", options_for_select([["ëª¨ë¸ ì„ íƒ", ""]]), {}, { 
                  class: "w-full px-3 sm:px-4 py-3 sm:py-4 text-sm sm:text-base border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white hover:border-blue-300 disabled:bg-gray-50 disabled:text-gray-400",
                  id: "model-select",
                  disabled: true,
                  autocomplete: "off"
                } %>
              </div>
              <div class="space-y-2 sm:col-span-2 lg:col-span-1">
                <label class="block text-sm font-medium text-gray-700 sm:hidden">ì˜ˆìƒ ê°€ê²©</label>
                <input type="text" id="price-display" placeholder="ì˜ˆìƒ ê°€ê²©" class="w-full px-3 sm:px-4 py-3 sm:py-4 text-sm sm:text-base border border-gray-300 rounded-lg sm:rounded-xl bg-gray-50 text-gray-600 font-medium" readonly>
              </div>
            </div>
            
            <!-- ì¶”ê°€ ì˜µì…˜ -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8">
              <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700 sm:hidden">ì—°ë£Œ íƒ€ì…</label>
                <%= f.select "fuel_type", options_for_select([
                  ["ì—°ë£Œ íƒ€ì…", ""],
                  ["ê°€ì†”ë¦°", "ê°€ì†”ë¦°"],
                  ["ë””ì ¤", "ë””ì ¤"],
                  ["í•˜ì´ë¸Œë¦¬ë“œ", "í•˜ì´ë¸Œë¦¬ë“œ"],
                  ["ì „ê¸°", "ì „ê¸°"],
                  ["ìˆ˜ì†Œ", "ìˆ˜ì†Œ"]
                ]), {}, { class: "w-full px-3 sm:px-4 py-3 sm:py-4 text-sm sm:text-base border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white hover:border-blue-300" } %>
              </div>
              <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700 sm:hidden">ì˜ˆì‚° ë²”ìœ„</label>
                <%= f.select "budget", options_for_select([
                  ["ì˜ˆì‚° ë²”ìœ„", ""],
                  ["2ì²œë§Œì› ì´í•˜", "20000000"],
                  ["2ì²œ-3ì²œë§Œì›", "30000000"],
                  ["3ì²œ-4ì²œë§Œì›", "40000000"],
                  ["4ì²œ-5ì²œë§Œì›", "50000000"],
                  ["5ì²œë§Œì› ì´ìƒ", "50000001"]
                ]), {}, { class: "w-full px-3 sm:px-4 py-3 sm:py-4 text-sm sm:text-base border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white hover:border-blue-300" } %>
              </div>
            </div>
            
            <div class="text-center">
              <button type="button" id="estimate-button" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white px-6 sm:px-8 lg:px-12 py-3 sm:py-4 rounded-lg sm:rounded-xl text-base sm:text-lg font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-lg active:scale-95 min-h-[48px] touch-manipulation border-0 outline-none" style="background-color: #2563eb !important; color: white !important;">
                <span class="flex items-center justify-center gap-2 text-white">
                  <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                  <span class="text-white font-semibold">ë¬´ë£Œ ê²¬ì  ë°›ê¸°</span>
                </span>
              </button>
            </div>
          <% end %>
          <p class="text-xs sm:text-sm text-gray-500 mt-3 sm:mt-4 text-center leading-relaxed">
            <span class="inline-flex items-center gap-1">
              <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
              </svg>
              ê²¬ì  ìš”ì²­ í›„ 24ì‹œê°„ ë‚´ ë³µìˆ˜ì˜ ë”œëŸ¬ê°€ ê²½ìŸ ê²¬ì ì„ ì œì‹œí•©ë‹ˆë‹¤
            </span>
          </p>
        </div>
      </div>

      <script>
        let isInitialized = false;
        
        document.addEventListener('DOMContentLoaded', function() {
          console.log('ğŸš€ í™ˆí˜ì´ì§€ DOMContentLoaded ì‹œì‘');
          if (!isInitialized) {
            initializePage();
            isInitialized = true;
            
            // initializePage ì™„ë£Œ í›„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            setTimeout(function() {
              setupEventListeners();
            }, 100);
          }
        });

        // í˜ì´ì§€ í‘œì‹œ ì‹œì—ë„ ì´ˆê¸°í™” (ë’¤ë¡œê°€ê¸° ëŒ€ì‘)
        window.addEventListener('pageshow', function(event) {
          // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ê³  ì´ˆê¸°í™” (ë¸Œë¼ìš°ì € ë³µì› ì™„ë£Œ í›„)
          setTimeout(function() {
            if (!isInitialized) {
              initializePage();
              isInitialized = true;
            } else {
              // ì´ë¯¸ ì´ˆê¸°í™”ëœ ê²½ìš° í¼ë§Œ ë¦¬ì…‹í•˜ê³  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ë“±ë¡
              safeResetForm();
              setupEventListeners(); // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ë“±ë¡
            }
          }, 100);
        });

        function initializePage() {
          // í¼ ì™„ì „ ì´ˆê¸°í™”
          safeResetForm();
          
          // ê²¬ì  ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
          const estimateButton = document.getElementById('estimate-button');
          if (estimateButton) {
            estimateButton.addEventListener('click', goToEstimate);
          }
        }

        function safeResetForm() {
          try {
            // DOM ì¡°ì‘ ì „ ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„ì‹œ ì œê±°
            const brandSelect = document.getElementById('brand-select');
            const modelSelect = document.getElementById('model-select');
            const priceDisplay = document.getElementById('price-display');
            const estimateButton = document.getElementById('estimate-button');
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„ì‹œ ì œê±°
            if (brandSelect) {
              brandSelect.onchange = null;
            }
            if (modelSelect) {
              modelSelect.onchange = null;
            }
            
            // í¼ í•„ë“œ ì´ˆê¸°í™”
            if (brandSelect) {
              brandSelect.value = '';
              brandSelect.selectedIndex = 0;
            }
            
            if (modelSelect) {
              modelSelect.innerHTML = '<option value="">ëª¨ë¸ ì„ íƒ</option>';
              modelSelect.value = '';
              modelSelect.selectedIndex = 0;
              modelSelect.disabled = true;
            }
            
            if (priceDisplay) {
              priceDisplay.value = '';
            }
            
            if (estimateButton) {
              estimateButton.disabled = false;
              estimateButton.textContent = 'ë¬´ë£Œ ê²¬ì  ë°›ê¸°';
            }
            
            // ì¶”ê°€ í•„ë“œë“¤ ì´ˆê¸°í™”
            const fuelTypeSelect = document.querySelector('select[name="fuel_type"]');
            const budgetSelect = document.querySelector('select[name="budget"]');
            if (fuelTypeSelect) {
              fuelTypeSelect.value = '';
              fuelTypeSelect.selectedIndex = 0;
            }
            if (budgetSelect) {
              budgetSelect.value = '';
              budgetSelect.selectedIndex = 0;
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” DOMContentLoadedì—ì„œ ë“±ë¡í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì œê±°
            console.log('ğŸ”„ safeResetForm ì™„ë£Œ - ì´ë²¤íŠ¸ëŠ” DOMContentLoadedì—ì„œ ì²˜ë¦¬');
            
          } catch (error) {
            console.log('Form reset error:', error);
          }
        }

        const carData = {
          "í˜„ëŒ€": {
            "ì•„ë°˜ë–¼": { price: "2,090ë§Œì›~", range: "2,090~2,490ë§Œì›" },
            "ì˜ë‚˜íƒ€": { price: "2,899ë§Œì›~", range: "2,899~3,599ë§Œì›" },
            "ê·¸ëœì €": { price: "3,520ë§Œì›~", range: "3,520~4,280ë§Œì›" },
            "ì•„ì´ì˜¤ë‹‰5": { price: "5,200ë§Œì›~", range: "5,200~5,900ë§Œì›" },
            "ì•„ì´ì˜¤ë‹‰6": { price: "5,290ë§Œì›~", range: "5,290~6,200ë§Œì›" },
            "íˆ¬ì‹¼": { price: "2,755ë§Œì›~", range: "2,755~3,455ë§Œì›" },
            "ì‹¼íƒ€í˜": { price: "3,515ë§Œì›~", range: "3,515~4,515ë§Œì›" },
            "íŒ°ë¦¬ì„¸ì´ë“œ": { price: "3,838ë§Œì›~", range: "3,838~4,738ë§Œì›" },
            "ìºìŠ¤í¼": { price: "1,385ë§Œì›~", range: "1,385~1,695ë§Œì›" },
            "ë² ë‰´": { price: "1,969ë§Œì›~", range: "1,969~2,369ë§Œì›" }
          },
          "ê¸°ì•„": {
            "K3": { price: "1,955ë§Œì›~", range: "1,955~2,555ë§Œì›" },
            "K5": { price: "2,760ë§Œì›~", range: "2,760~3,460ë§Œì›" },
            "K8": { price: "3,305ë§Œì›~", range: "3,305~4,205ë§Œì›" },
            "K9": { price: "4,630ë§Œì›~", range: "4,630~6,030ë§Œì›" },
            "EV6": { price: "4,880ë§Œì›~", range: "4,880~6,280ë§Œì›" },
            "EV9": { price: "7,300ë§Œì›~", range: "7,300~8,900ë§Œì›" },
            "ì…€í† ìŠ¤": { price: "2,268ë§Œì›~", range: "2,268~2,968ë§Œì›" },
            "ìŠ¤í¬í‹°ì§€": { price: "2,755ë§Œì›~", range: "2,755~3,655ë§Œì›" },
            "ì˜ë Œí† ": { price: "3,193ë§Œì›~", range: "3,193~4,293ë§Œì›" },
            "ëª¨í•˜ë¹„": { price: "4,173ë§Œì›~", range: "4,173~5,073ë§Œì›" },
            "ë ˆì´": { price: "1,435ë§Œì›~", range: "1,435~1,735ë§Œì›" },
            "ëª¨ë‹": { price: "1,285ë§Œì›~", range: "1,285~1,585ë§Œì›" }
          },
          "ì œë„¤ì‹œìŠ¤": {
            "G70": { price: "4,500ë§Œì›~", range: "4,500~6,200ë§Œì›" },
            "G80": { price: "5,405ë§Œì›~", range: "5,405~7,605ë§Œì›" },
            "G90": { price: "8,700ë§Œì›~", range: "8,700~12,400ë§Œì›" },
            "GV70": { price: "5,030ë§Œì›~", range: "5,030~7,230ë§Œì›" },
            "GV80": { price: "6,930ë§Œì›~", range: "6,930~9,630ë§Œì›" },
            "GV60": { price: "5,990ë§Œì›~", range: "5,990~6,890ë§Œì›" },
            "ì „ë™í™” G80": { price: "7,755ë§Œì›~", range: "7,755~8,655ë§Œì›" },
            "ì „ë™í™” GV70": { price: "6,580ë§Œì›~", range: "6,580~7,480ë§Œì›" }
          },
          "BMW": {
            "1ì‹œë¦¬ì¦ˆ": { price: "4,200ë§Œì›~", range: "4,200~5,200ë§Œì›" },
            "2ì‹œë¦¬ì¦ˆ": { price: "4,890ë§Œì›~", range: "4,890~6,890ë§Œì›" },
            "3ì‹œë¦¬ì¦ˆ": { price: "5,500ë§Œì›~", range: "5,500~8,500ë§Œì›" },
            "4ì‹œë¦¬ì¦ˆ": { price: "6,200ë§Œì›~", range: "6,200~9,200ë§Œì›" },
            "5ì‹œë¦¬ì¦ˆ": { price: "7,400ë§Œì›~", range: "7,400~12,400ë§Œì›" },
            "7ì‹œë¦¬ì¦ˆ": { price: "13,900ë§Œì›~", range: "13,900~25,900ë§Œì›" },
            "X1": { price: "4,750ë§Œì›~", range: "4,750~6,250ë§Œì›" },
            "X3": { price: "6,200ë§Œì›~", range: "6,200~9,200ë§Œì›" },
            "X5": { price: "8,900ë§Œì›~", range: "8,900~14,900ë§Œì›" },
            "X7": { price: "12,400ë§Œì›~", range: "12,400~20,400ë§Œì›" },
            "iX3": { price: "7,700ë§Œì›~", range: "7,700~8,700ë§Œì›" },
            "i4": { price: "6,999ë§Œì›~", range: "6,999~8,999ë§Œì›" }
          },
          "ë²¤ì¸ ": {
            "Aí´ë˜ìŠ¤": { price: "4,200ë§Œì›~", range: "4,200~6,200ë§Œì›" },
            "Cí´ë˜ìŠ¤": { price: "5,500ë§Œì›~", range: "5,500~8,500ë§Œì›" },
            "Eí´ë˜ìŠ¤": { price: "7,200ë§Œì›~", range: "7,200~12,200ë§Œì›" },
            "Sí´ë˜ìŠ¤": { price: "13,500ë§Œì›~", range: "13,500~28,500ë§Œì›" },
            "GLA": { price: "4,750ë§Œì›~", range: "4,750~6,750ë§Œì›" },
            "GLB": { price: "5,200ë§Œì›~", range: "5,200~7,200ë§Œì›" },
            "GLC": { price: "6,400ë§Œì›~", range: "6,400~9,400ë§Œì›" },
            "GLE": { price: "8,900ë§Œì›~", range: "8,900~15,900ë§Œì›" },
            "GLS": { price: "12,800ë§Œì›~", range: "12,800~22,800ë§Œì›" },
            "EQA": { price: "5,999ë§Œì›~", range: "5,999~6,999ë§Œì›" },
            "EQB": { price: "6,499ë§Œì›~", range: "6,499~7,499ë§Œì›" },
            "EQC": { price: "8,999ë§Œì›~", range: "8,999~9,999ë§Œì›" }
          },
          "ì•„ìš°ë””": {
            "A3": { price: "4,200ë§Œì›~", range: "4,200~5,700ë§Œì›" },
            "A4": { price: "5,500ë§Œì›~", range: "5,500~7,500ë§Œì›" },
            "A6": { price: "7,200ë§Œì›~", range: "7,200~10,200ë§Œì›" },
            "A8": { price: "12,900ë§Œì›~", range: "12,900~22,900ë§Œì›" },
            "Q2": { price: "4,100ë§Œì›~", range: "4,100~5,100ë§Œì›" },
            "Q3": { price: "4,890ë§Œì›~", range: "4,890~6,390ë§Œì›" },
            "Q5": { price: "6,400ë§Œì›~", range: "6,400~8,900ë§Œì›" },
            "Q7": { price: "9,200ë§Œì›~", range: "9,200~14,200ë§Œì›" },
            "Q8": { price: "10,500ë§Œì›~", range: "10,500~16,500ë§Œì›" },
            "e-tron": { price: "9,999ë§Œì›~", range: "9,999~12,999ë§Œì›" },
            "e-tron GT": { price: "13,999ë§Œì›~", range: "13,999~19,999ë§Œì›" }
          },
          "ë³¼ë³´": {
            "XC40": { price: "4,590ë§Œì›~", range: "4,590~6,090ë§Œì›" },
            "XC60": { price: "6,200ë§Œì›~", range: "6,200~8,700ë§Œì›" },
            "XC90": { price: "8,200ë§Œì›~", range: "8,200~12,200ë§Œì›" },
            "S60": { price: "4,990ë§Œì›~", range: "4,990~6,490ë§Œì›" },
            "S90": { price: "6,500ë§Œì›~", range: "6,500~8,500ë§Œì›" },
            "XC40 ë¦¬ì°¨ì§€": { price: "5,999ë§Œì›~", range: "5,999~6,999ë§Œì›" },
            "XC60 ë¦¬ì°¨ì§€": { price: "7,499ë§Œì›~", range: "7,499~8,499ë§Œì›" },
            "XC90 ë¦¬ì°¨ì§€": { price: "9,499ë§Œì›~", range: "9,499~11,499ë§Œì›" }
          },
          "ë ‰ì„œìŠ¤": {
            "IS": { price: "4,700ë§Œì›~", range: "4,700~6,200ë§Œì›" },
            "ES": { price: "5,500ë§Œì›~", range: "5,500~7,000ë§Œì›" },
            "LS": { price: "11,900ë§Œì›~", range: "11,900~19,900ë§Œì›" },
            "NX": { price: "5,200ë§Œì›~", range: "5,200~7,200ë§Œì›" },
            "RX": { price: "7,200ë§Œì›~", range: "7,200~10,200ë§Œì›" },
            "GX": { price: "9,500ë§Œì›~", range: "9,500~11,500ë§Œì›" },
            "LX": { price: "13,500ë§Œì›~", range: "13,500~16,500ë§Œì›" },
            "UX": { price: "4,200ë§Œì›~", range: "4,200~5,200ë§Œì›" },
            "LC": { price: "12,900ë§Œì›~", range: "12,900~15,900ë§Œì›" }
          }
        };

        function updateModels() {
          try {
            const brandSelect = document.getElementById('brand-select');
            const modelSelect = document.getElementById('model-select');
            const priceDisplay = document.getElementById('price-display');
            
            if (!brandSelect || !modelSelect || !priceDisplay) return;
            
            const selectedBrand = brandSelect.value;
            
            // ì™„ì „í•œ ëª¨ë¸ ì„ íƒ ì´ˆê¸°í™” (í™ˆí˜ì´ì§€ìš©)
            modelSelect.innerHTML = '<option value="">ëª¨ë¸ ì„ íƒ</option>';
            modelSelect.value = '';
            modelSelect.selectedIndex = 0;
            priceDisplay.value = '';
            
            if (selectedBrand && carData[selectedBrand]) {
              modelSelect.disabled = false;
              
              // í•´ë‹¹ ë¸Œëœë“œì˜ ëª¨ë¸ë“¤ ì¶”ê°€ (ìë™ ì„ íƒ ì—†ìŒ)
              Object.keys(carData[selectedBrand]).forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                // í™ˆí˜ì´ì§€ì—ì„œëŠ” ì ˆëŒ€ ìë™ ì„ íƒí•˜ì§€ ì•ŠìŒ
                modelSelect.appendChild(option);
              });
            } else {
              modelSelect.disabled = true;
            }
            
            console.log('ğŸ”„ í™ˆí˜ì´ì§€ updateModels ì™„ë£Œ, ë¸Œëœë“œ:', selectedBrand);
            
          } catch (error) {
            console.log('Update models error:', error);
          }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • í•¨ìˆ˜ ì¶”ê°€
        function setupEventListeners() {
          const brandSelect = document.getElementById('brand-select');
          const modelSelect = document.getElementById('model-select');
          
          if (brandSelect) {
            // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° í›„ ìƒˆë¡œ ë“±ë¡
            brandSelect.removeEventListener('change', handleBrandChange);
            brandSelect.addEventListener('change', handleBrandChange);
            console.log('âœ… ë¸Œëœë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ë¨');
          }
          
          if (modelSelect) {
            // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° í›„ ìƒˆë¡œ ë“±ë¡
            modelSelect.removeEventListener('change', handleModelChange);
            modelSelect.addEventListener('change', handleModelChange);
            console.log('âœ… ëª¨ë¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ë¨');
          }
        }
        
        // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ë“¤
        function handleBrandChange() {
          console.log('ğŸ”„ ë¸Œëœë“œ ë³€ê²½:', this.value);
          updateModels();
        }
        
        function handleModelChange() {
          console.log('ğŸ”„ ëª¨ë¸ ë³€ê²½:', this.value);
          updatePrice();
        }

        // ëˆ„ë½ëœ updateModels í•¨ìˆ˜ ì¶”ê°€!
        function updateModels() {
          console.log('ğŸ”„ updateModels í•¨ìˆ˜ ì‹¤í–‰ë¨');
          const brandSelect = document.getElementById('brand-select');
          const modelSelect = document.getElementById('model-select');
          const priceDisplay = document.getElementById('price-display');
          
          if (!brandSelect || !modelSelect || !priceDisplay) {
            console.log('âŒ í•„ìˆ˜ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            return;
          }
          
          const selectedBrand = brandSelect.value;
          console.log('ğŸ” ì„ íƒëœ ë¸Œëœë“œ:', selectedBrand);
          
          // ëª¨ë¸ ì„ íƒ ì™„ì „ ì´ˆê¸°í™”
          modelSelect.innerHTML = '<option value="">ëª¨ë¸ ì„ íƒ</option>';
          modelSelect.value = '';
          modelSelect.selectedIndex = 0;
          priceDisplay.value = '';
          
          if (selectedBrand && carData[selectedBrand]) {
            modelSelect.disabled = false; // ì¤‘ìš”: í™œì„±í™”!
            console.log('âœ… ëª¨ë¸ ì„ íƒ í™œì„±í™”ë¨');
            
            Object.keys(carData[selectedBrand]).forEach(model => {
              const option = document.createElement('option');
              option.value = model;
              option.textContent = model;
              modelSelect.appendChild(option);
            });
            console.log('âœ… ëª¨ë¸ ëª©ë¡ ì—…ë°ì´íŠ¸ë¨, ëª¨ë¸ ìˆ˜:', Object.keys(carData[selectedBrand]).length);
          } else {
            modelSelect.disabled = true;
            console.log('âŒ ëª¨ë¸ ì„ íƒ ë¹„í™œì„±í™”ë¨');
          }
        }

        function updatePrice() {
          const brandSelect = document.getElementById('brand-select');
          const modelSelect = document.getElementById('model-select');
          const priceDisplay = document.getElementById('price-display');
          
          const selectedBrand = brandSelect.value;
          const selectedModel = modelSelect.value;
          
          console.log('ğŸ” ê°€ê²© ì—…ë°ì´íŠ¸ - ë¸Œëœë“œ:', selectedBrand, 'ëª¨ë¸:', selectedModel);
          
          // ë¹ˆ ê°’ì´ê±°ë‚˜ "ëª¨ë¸ ì„ íƒ"ì¸ ê²½ìš° ê°€ê²© í‘œì‹œ ì•ˆí•¨
          if (selectedBrand && selectedModel && selectedModel !== '' && carData[selectedBrand] && carData[selectedBrand][selectedModel]) {
            priceDisplay.value = carData[selectedBrand][selectedModel].range;
            console.log('âœ… ê°€ê²© ì—…ë°ì´íŠ¸ë¨:', carData[selectedBrand][selectedModel].range);
          } else {
            priceDisplay.value = '';
            console.log('âŒ ê°€ê²© ì´ˆê¸°í™”ë¨');
          }
        }

        function goToEstimate() {
          // ë²„íŠ¼ ì¤‘ë³µ í´ë¦­ ë°©ì§€
          const button = event.target;
          if (button.disabled) return;
          
          button.disabled = true;
          button.textContent = 'ì²˜ë¦¬ ì¤‘...';
          
          const brandSelect = document.getElementById('brand-select');
          const modelSelect = document.getElementById('model-select');
          
          const selectedBrand = brandSelect ? brandSelect.value : '';
          const selectedModel = modelSelect ? modelSelect.value : '';
          
          let targetUrl = '/estimates/start';
          
          if (selectedBrand && selectedModel) {
            targetUrl = `/estimates/start?brand=${encodeURIComponent(selectedBrand)}&model=${encodeURIComponent(selectedModel)}`;
          } else if (selectedBrand) {
            targetUrl = `/estimates/start?brand=${encodeURIComponent(selectedBrand)}`;
          }
          
          // ì•½ê°„ì˜ ì§€ì—° í›„ í˜ì´ì§€ ì´ë™ (ì‚¬ìš©ì í”¼ë“œë°±)
          setTimeout(() => {
            window.location.href = targetUrl;
          }, 300);
        }
      </script>

      <!-- Key Benefits -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
        <div>
          <div class="text-3xl font-bold text-blue-600">700+</div>
          <div class="text-gray-600">ì „êµ­ ì „ì‹œì¥</div>
        </div>
        <div>
          <div class="text-3xl font-bold text-blue-600">8,000+</div>
          <div class="text-gray-600">ë”œëŸ¬ ë„¤íŠ¸ì›Œí¬</div>
        </div>
        <div>
          <div class="text-3xl font-bold text-blue-600">ìµœëŒ€ 15%</div>
          <div class="text-gray-600">í• ì¸ í˜œíƒ</div>
        </div>
        <div>
          <div class="text-3xl font-bold text-blue-600">5%</div>
          <div class="text-gray-600">ì˜¤í† ìºì‹œë°±</div>
        </div>
      </div>
      
      <!-- Hero Car Showcase -->
      <div class="mt-16">
        <img src="/generated_images/hero_showcase.jpg" alt="ì¹´ë…¸íŠ¸ ì‹ ì°¨ ì‡¼ì¼€ì´ìŠ¤" class="mx-auto rounded-2xl shadow-2xl max-w-4xl w-full">
      </div>
    </div>
  </div>
</section>

<!-- Popular New Cars Section -->
<section class="py-16 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">ì¸ê¸° ì‹ ì°¨ ëª¨ë¸</h2>
      <p class="text-gray-600">ì§€ê¸ˆ ê°€ì¥ ë§ì€ ê²¬ì  ìš”ì²­ì„ ë°›ê³  ìˆëŠ” ì‹ ì°¨ ëª¨ë¸ë“¤</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      <% Car.includes(:user, :reviews, images_attachments: :blob).order(created_at: :desc).limit(6).each_with_index do |car, index| %>
        <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow relative">
          <% if car.images.attached? %>
            <%= image_tag car.images.first.representation(resize_to_limit: [400, 250]), class: "w-full h-48 object-cover" %>
          <% else %>
            <% 
              # ê¸°ë³¸ ìë™ì°¨ ì´ë¯¸ì§€ë“¤ì„ ìˆœí™˜í•˜ì—¬ ì‚¬ìš©
              default_images = ["car_1.jpg", "car_2.jpg", "car_3.jpg", "car_4.jpg", "car_5.jpg", "car_6.jpg"]
              image_name = default_images[index % default_images.length]
            %>
            <img src="/generated_images/<%= image_name %>" alt="<%= car.make %> <%= car.model %>" class="w-full h-48 object-cover">
          <% end %>
          
          <!-- Discount Badge -->
          <div class="absolute top-4 left-4">
            <span class="bg-red-500 text-white px-2 py-1 rounded text-sm font-semibold">ìµœëŒ€ <%= rand(5..15) %>% í• ì¸</span>
          </div>
          
          <div class="p-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-2"><%= car.make %> <%= car.model %></h3>
            <p class="text-gray-600 mb-4"><%= car.year %>ë…„í˜• ì‹ ì°¨</p>
            
            <div class="mb-4">
              <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-500">ì‹ ì°¨ ì¶œê³ ê°€</span>
                <span class="text-lg text-gray-400 line-through">â‚©<%= number_to_currency(car.price * 1.1, precision: 0, unit: "") %></span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm font-semibold text-blue-600">ì¹´ë…¸íŠ¸ ìµœì €ê°€</span>
                <span class="text-2xl font-bold text-blue-600">â‚©<%= number_to_currency(car.price, precision: 0, unit: "") %></span>
              </div>
            </div>
            
            <div class="space-y-2">
              <%= link_to "ê²¬ì  ë°›ê¸°", car_path(car), class: "block w-full text-center bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors font-medium" %>
              <div class="grid grid-cols-2 gap-2">
                <button class="text-center border border-gray-300 text-gray-700 py-1 rounded text-sm hover:bg-gray-50">í• ë¶€ ê³„ì‚°</button>
                <button class="text-center border border-gray-300 text-gray-700 py-1 rounded text-sm hover:bg-gray-50">ë¦¬ìŠ¤ ê²¬ì </button>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <div class="text-center mt-12">
      <%= link_to "ì „ì²´ ì‹ ì°¨ ëª¨ë¸ ë³´ê¸°", cars_path, class: "inline-flex items-center px-6 py-3 border border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white rounded-lg transition-colors" %>
    </div>
  </div>
</section>

<!-- Why Choose CARNOTE Section -->
<section class="py-16 bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">ì™œ ì¹´ë…¸íŠ¸ë¥¼ ì„ íƒí•´ì•¼ í• ê¹Œìš”?</h2>
      <p class="text-gray-600">ì‹ ì°¨ êµ¬ë§¤ì˜ ìƒˆë¡œìš´ ê¸°ì¤€, ì¹´ë…¸íŠ¸ë§Œì˜ íŠ¹ë³„í•œ í˜œíƒ</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <div class="text-center">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">ë¹„êµ ê²¬ì  ì‹œìŠ¤í…œ</h3>
        <p class="text-gray-600">ë³µìˆ˜ì˜ ë”œëŸ¬ê°€ ê²½ìŸ ê²¬ì ì„ ì œì‹œí•˜ì—¬ ìµœì €ê°€ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤</p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">ì˜¤í† ìºì‹œë°±</h3>
        <p class="text-gray-600">ì¹´ë“œ ê²°ì œ ì‹œ ìµœëŒ€ 5% ìºì‹œë°±ìœ¼ë¡œ ì¶”ê°€ í• ì¸ í˜œíƒì„ ì œê³µí•©ë‹ˆë‹¤</p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">ë¹„ëŒ€ë©´ ê°„í¸ ê³„ì•½</h3>
        <p class="text-gray-600">ì˜¨ë¼ì¸ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ìƒë‹´ë¶€í„° ê³„ì•½ê¹Œì§€ ì›ìŠ¤í†± ì„œë¹„ìŠ¤</p>
      </div>
    </div>
  </div>
</section>

<!-- Financial Products Section -->
<section class="py-16 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">ë‹¤ì–‘í•œ ê¸ˆìœµ ìƒí’ˆ</h2>
      <p class="text-gray-600">í• ë¶€ë¶€í„° ë¦¬ìŠ¤ê¹Œì§€, ë‚˜ì—ê²Œ ë§ëŠ” ìµœì ì˜ ê¸ˆìœµ ìƒí’ˆì„ ì°¾ì•„ë³´ì„¸ìš”</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <!-- í• ë¶€ -->
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 text-center">
        <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">í• ë¶€</h3>
        <p class="text-gray-600 mb-4">ë‚®ì€ ê¸ˆë¦¬ë¡œ ë¶€ë‹´ ì—†ëŠ” ì›” ë‚©ì…</p>
        <div class="text-2xl font-bold text-blue-600 mb-2">ì—° 2.9%~</div>
        <p class="text-sm text-gray-500">ìµœëŒ€ 84ê°œì›”</p>
      </div>

      <!-- ë¦¬ìŠ¤ -->
      <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 text-center">
        <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">ë¦¬ìŠ¤</h3>
        <p class="text-gray-600 mb-4">ë‚®ì€ ì›” ë‚©ì…ìœ¼ë¡œ ì‹ ì°¨ ì´ìš©</p>
        <div class="text-2xl font-bold text-green-600 mb-2">ì›” 30ë§Œì›~</div>
        <p class="text-sm text-gray-500">2~4ë…„ ì•½ì •</p>
      </div>

      <!-- ì¥ê¸°ë ŒíŠ¸ -->
      <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 text-center">
        <div class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">ì¥ê¸°ë ŒíŠ¸</h3>
        <p class="text-gray-600 mb-4">ë³´í—˜, ì •ë¹„ê¹Œì§€ ì˜¬ì¸ì› ì„œë¹„ìŠ¤</p>
        <div class="text-2xl font-bold text-purple-600 mb-2">ì›” 35ë§Œì›~</div>
        <p class="text-sm text-gray-500">2~5ë…„ ì•½ì •</p>
      </div>
    </div>

    <div class="text-center mt-12">
      <button class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg text-lg font-semibold transition-colors">
        ê¸ˆìœµ ìƒí’ˆ ë¹„êµí•˜ê¸°
      </button>
    </div>
  </div>
</section>